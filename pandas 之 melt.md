# pandas 之 melt

`melt` 有两种调用方式：

* 通过 `pandas` 的类方法方式调用

    ```python
    pd.melt(frame=df, ...)
    ```

* 通过 `DataFrame` 对象的实例方法调用

    ```python
    df.melt()
    ```

现有如下 `DataFrame` 类型的数据

|    语言    | 北京 | 上海 | 深圳 | 杭州 |
| :--------: | :--: | :--: | :--: | :--: |
|    C++     |  79  |  29  |  35  |  29  |
|    Java    |  61  |  40  |  29  |  50  |
|    PHP     |  19  |  61  |  53  |  77  |
|   Python   |  36  |  58  |  73  |  69  |
|   Swift    |  88  |  51  |  58  |  99  |
| JavaScript |  36  |  58  |  81  |  89  |

`CSV` 格式文件如下

```csv
语言,北京,上海,深圳,杭州
C++,79,29,35,29
Java,61,40,29,50
PHP,19,61,53,77
Python,36,58,73,69
Swift,88,51,58,99
JavaScript,36,58,81,89
```

调用

```python
pd.melt(frame=df_raw,
        id_vars=['语言'],
        var_name="城市",
        value_name="数量")
```

将得到

|      |    语言    | 城市 | 数量 |
| ---: | :--------: | :--: | :--: |
|    0 |    C++     | 北京 |  79  |
|    1 |    Java    | 北京 |  61  |
|    2 |    PHP     | 北京 |  19  |
|    3 |   Python   | 北京 |  36  |
|    4 |   Swift    | 北京 |  88  |
|    5 | JavaScript | 北京 |  36  |
|    6 |    C++     | 上海 |  29  |
|    7 |    Java    | 上海 |  40  |
|    8 |    PHP     | 上海 |  61  |
|    9 |   Python   | 上海 |  58  |
|   10 |   Swift    | 上海 |  51  |
|   11 | JavaScript | 上海 |  58  |
|   12 |    C++     | 深圳 |  35  |
|   13 |    Java    | 深圳 |  29  |
|   14 |    PHP     | 深圳 |  53  |
|   15 |   Python   | 深圳 |  73  |
|   16 |   Swift    | 深圳 |  58  |
|   17 | JavaScript | 深圳 |  81  |
|   18 |    C++     | 杭州 |  29  |
|   19 |    Java    | 杭州 |  50  |
|   20 |    PHP     | 杭州 |  77  |
|   21 |   Python   | 杭州 |  69  |
|   22 |   Swift    | 杭州 |  99  |
|   23 | JavaScript | 杭州 |  89  |

还可以在 `id_vars` 参数中传入多个列名的列表，以保持只对某些列的融化操作

现有如下 `DataFrame` 对象

|  歌手  |   专辑   | 第1周 | 第2周 | 第3周 | 第4周 |
| :----: | :------: | :---: | :---: | :---: | :---: |
| 周华健 |  忘忧草  |  57   |  56   |  64   |  96   |
| 周华健 |   朋友   |  94   |  44   |  65   |  99   |
| 罗大佑 | 之乎者也 |  64   |  11   |  52   |  55   |
| 李宗盛 | 男人三十 |  52   |  46   |  17   |  52   |

执行如下代码

```python
pd.melt(frame=df_raw,
        id_vars=['歌手', '专辑'],
        var_name="周",
        value_name="销量")
```

将得到

|      |  歌手  |   专辑   |  周   | 销量 |
| :--: | :----: | :------: | :---: | :--: |
|  0   | 周华健 |  忘忧草  | 第1周 |  57  |
|  1   | 周华健 |   朋友   | 第1周 |  94  |
|  2   | 罗大佑 | 之乎者也 | 第1周 |  64  |
|  3   | 李宗盛 | 男人三十 | 第1周 |  52  |
|  4   | 周华健 |  忘忧草  | 第2周 |  56  |
|  5   | 周华健 |   朋友   | 第2周 |  44  |
|  6   | 罗大佑 | 之乎者也 | 第2周 |  11  |
|  7   | 李宗盛 | 男人三十 | 第2周 |  46  |
|  8   | 周华健 |  忘忧草  | 第3周 |  64  |
|  9   | 周华健 |   朋友   | 第3周 |  65  |
|  10  | 罗大佑 | 之乎者也 | 第3周 |  52  |
|  11  | 李宗盛 | 男人三十 | 第3周 |  17  |
|  12  | 周华健 |  忘忧草  | 第4周 |  96  |
|  13  | 周华健 |   朋友   | 第4周 |  99  |
|  14  | 罗大佑 | 之乎者也 | 第4周 |  55  |
|  15  | 李宗盛 | 男人三十 | 第4周 |  52  |